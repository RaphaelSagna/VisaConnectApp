export interface City {
  city: string;
  state: string;
  fullName: string;
}

export const US_CITIES: City[] = [
  { city: 'New York', state: 'NY', fullName: 'New York, NY' },
  { city: 'Los Angeles', state: 'CA', fullName: 'Los Angeles, CA' },
  { city: 'Chicago', state: 'IL', fullName: 'Chicago, IL' },
  { city: 'Houston', state: 'TX', fullName: 'Houston, TX' },
  { city: 'Phoenix', state: 'AZ', fullName: 'Phoenix, AZ' },
  { city: 'Philadelphia', state: 'PA', fullName: 'Philadelphia, PA' },
  { city: 'San Antonio', state: 'TX', fullName: 'San Antonio, TX' },
  { city: 'San Diego', state: 'CA', fullName: 'San Diego, CA' },
  { city: 'Dallas', state: 'TX', fullName: 'Dallas, TX' },
  { city: 'San Jose', state: 'CA', fullName: 'San Jose, CA' },
  { city: 'Austin', state: 'TX', fullName: 'Austin, TX' },
  { city: 'Jacksonville', state: 'FL', fullName: 'Jacksonville, FL' },
  { city: 'Fort Worth', state: 'TX', fullName: 'Fort Worth, TX' },
  { city: 'Columbus', state: 'OH', fullName: 'Columbus, OH' },
  { city: 'Charlotte', state: 'NC', fullName: 'Charlotte, NC' },
  { city: 'San Francisco', state: 'CA', fullName: 'San Francisco, CA' },
  { city: 'Indianapolis', state: 'IN', fullName: 'Indianapolis, IN' },
  { city: 'Seattle', state: 'WA', fullName: 'Seattle, WA' },
  { city: 'Denver', state: 'CO', fullName: 'Denver, CO' },
  { city: 'Washington', state: 'DC', fullName: 'Washington, DC' },
  { city: 'Boston', state: 'MA', fullName: 'Boston, MA' },
  { city: 'El Paso', state: 'TX', fullName: 'El Paso, TX' },
  { city: 'Nashville', state: 'TN', fullName: 'Nashville, TN' },
  { city: 'Detroit', state: 'MI', fullName: 'Detroit, MI' },
  { city: 'Oklahoma City', state: 'OK', fullName: 'Oklahoma City, OK' },
  { city: 'Portland', state: 'OR', fullName: 'Portland, OR' },
  { city: 'Las Vegas', state: 'NV', fullName: 'Las Vegas, NV' },
  { city: 'Memphis', state: 'TN', fullName: 'Memphis, TN' },
  { city: 'Louisville', state: 'KY', fullName: 'Louisville, KY' },
  { city: 'Baltimore', state: 'MD', fullName: 'Baltimore, MD' },
  { city: 'Milwaukee', state: 'WI', fullName: 'Milwaukee, WI' },
  { city: 'Albuquerque', state: 'NM', fullName: 'Albuquerque, NM' },
  { city: 'Tucson', state: 'AZ', fullName: 'Tucson, AZ' },
  { city: 'Fresno', state: 'CA', fullName: 'Fresno, CA' },
  { city: 'Sacramento', state: 'CA', fullName: 'Sacramento, CA' },
  { city: 'Mesa', state: 'AZ', fullName: 'Mesa, AZ' },
  { city: 'Kansas City', state: 'MO', fullName: 'Kansas City, MO' },
  { city: 'Atlanta', state: 'GA', fullName: 'Atlanta, GA' },
  { city: 'Long Beach', state: 'CA', fullName: 'Long Beach, CA' },
  { city: 'Colorado Springs', state: 'CO', fullName: 'Colorado Springs, CO' },
  { city: 'Raleigh', state: 'NC', fullName: 'Raleigh, NC' },
  { city: 'Miami', state: 'FL', fullName: 'Miami, FL' },
  { city: 'Virginia Beach', state: 'VA', fullName: 'Virginia Beach, VA' },
  { city: 'Omaha', state: 'NE', fullName: 'Omaha, NE' },
  { city: 'Oakland', state: 'CA', fullName: 'Oakland, CA' },
  { city: 'Minneapolis', state: 'MN', fullName: 'Minneapolis, MN' },
  { city: 'Tulsa', state: 'OK', fullName: 'Tulsa, OK' },
  { city: 'Arlington', state: 'TX', fullName: 'Arlington, TX' },
  { city: 'Tampa', state: 'FL', fullName: 'Tampa, FL' },
  { city: 'New Orleans', state: 'LA', fullName: 'New Orleans, LA' },
  { city: 'Wichita', state: 'KS', fullName: 'Wichita, KS' },
  { city: 'Cleveland', state: 'OH', fullName: 'Cleveland, OH' },
  { city: 'Bakersfield', state: 'CA', fullName: 'Bakersfield, CA' },
  { city: 'Aurora', state: 'CO', fullName: 'Aurora, CO' },
  { city: 'Anaheim', state: 'CA', fullName: 'Anaheim, CA' },
  { city: 'Honolulu', state: 'HI', fullName: 'Honolulu, HI' },
  { city: 'Santa Ana', state: 'CA', fullName: 'Santa Ana, CA' },
  { city: 'Corpus Christi', state: 'TX', fullName: 'Corpus Christi, TX' },
  { city: 'Riverside', state: 'CA', fullName: 'Riverside, CA' },
  { city: 'Lexington', state: 'KY', fullName: 'Lexington, KY' },
  { city: 'Stockton', state: 'CA', fullName: 'Stockton, CA' },
  { city: 'Henderson', state: 'NV', fullName: 'Henderson, NV' },
  { city: 'Saint Paul', state: 'MN', fullName: 'Saint Paul, MN' },
  { city: 'St. Louis', state: 'MO', fullName: 'St. Louis, MO' },
  { city: 'Cincinnati', state: 'OH', fullName: 'Cincinnati, OH' },
  { city: 'Pittsburgh', state: 'PA', fullName: 'Pittsburgh, PA' },
  { city: 'Greensboro', state: 'NC', fullName: 'Greensboro, NC' },
  { city: 'Anchorage', state: 'AK', fullName: 'Anchorage, AK' },
  { city: 'Plano', state: 'TX', fullName: 'Plano, TX' },
  { city: 'Lincoln', state: 'NE', fullName: 'Lincoln, NE' },
  { city: 'Orlando', state: 'FL', fullName: 'Orlando, FL' },
  { city: 'Irvine', state: 'CA', fullName: 'Irvine, CA' },
  { city: 'Newark', state: 'NJ', fullName: 'Newark, NJ' },
  { city: 'Durham', state: 'NC', fullName: 'Durham, NC' },
  { city: 'Chula Vista', state: 'CA', fullName: 'Chula Vista, CA' },
  { city: 'Toledo', state: 'OH', fullName: 'Toledo, OH' },
  { city: 'Fort Wayne', state: 'IN', fullName: 'Fort Wayne, IN' },
  { city: 'St. Petersburg', state: 'FL', fullName: 'St. Petersburg, FL' },
  { city: 'Laredo', state: 'TX', fullName: 'Laredo, TX' },
  { city: 'Jersey City', state: 'NJ', fullName: 'Jersey City, NJ' },
  { city: 'Chandler', state: 'AZ', fullName: 'Chandler, AZ' },
  { city: 'Madison', state: 'WI', fullName: 'Madison, WI' },
  { city: 'Lubbock', state: 'TX', fullName: 'Lubbock, TX' },
  { city: 'Scottsdale', state: 'AZ', fullName: 'Scottsdale, AZ' },
  { city: 'Reno', state: 'NV', fullName: 'Reno, NV' },
  { city: 'Buffalo', state: 'NY', fullName: 'Buffalo, NY' },
  { city: 'Gilbert', state: 'AZ', fullName: 'Gilbert, AZ' },
  { city: 'Glendale', state: 'AZ', fullName: 'Glendale, AZ' },
  { city: 'North Las Vegas', state: 'NV', fullName: 'North Las Vegas, NV' },
  { city: 'Winston-Salem', state: 'NC', fullName: 'Winston-Salem, NC' },
  { city: 'Chesapeake', state: 'VA', fullName: 'Chesapeake, VA' },
  { city: 'Norfolk', state: 'VA', fullName: 'Norfolk, VA' },
  { city: 'Fremont', state: 'CA', fullName: 'Fremont, CA' },
  { city: 'Garland', state: 'TX', fullName: 'Garland, TX' },
  { city: 'Irving', state: 'TX', fullName: 'Irving, TX' },
  { city: 'Hialeah', state: 'FL', fullName: 'Hialeah, FL' },
  { city: 'Richmond', state: 'VA', fullName: 'Richmond, VA' },
  { city: 'Boise', state: 'ID', fullName: 'Boise, ID' },
  { city: 'Spokane', state: 'WA', fullName: 'Spokane, WA' },
  { city: 'Baton Rouge', state: 'LA', fullName: 'Baton Rouge, LA' },
];

export const searchCities = (query: string): City[] => {
  if (!query || query.length < 2) return [];

  const lowerQuery = query.toLowerCase();

  // Enhanced search with better matching logic
  return US_CITIES.filter((city) => {
    const cityLower = city.city.toLowerCase();
    const stateLower = city.state.toLowerCase();
    const fullNameLower = city.fullName.toLowerCase();

    // Direct matches (highest priority)
    if (cityLower.startsWith(lowerQuery) || stateLower.startsWith(lowerQuery)) {
      return true;
    }

    // Contains matches
    if (cityLower.includes(lowerQuery) || stateLower.includes(lowerQuery)) {
      return true;
    }

    // Full name matches
    if (fullNameLower.includes(lowerQuery)) {
      return true;
    }

    // State abbreviation followed by city (e.g., "NY New" matches "New York, NY")
    if (
      stateLower.startsWith(lowerQuery.substring(0, 2)) &&
      cityLower.includes(lowerQuery.substring(2).trim())
    ) {
      return true;
    }

    return false;
  })
    .sort((a, b) => {
      // Sort by relevance: exact matches first, then starts with, then contains
      const aCityLower = a.city.toLowerCase();
      const bCityLower = b.city.toLowerCase();
      const aStateLower = a.state.toLowerCase();
      const bStateLower = b.state.toLowerCase();

      // Exact matches get highest priority
      if (aCityLower === lowerQuery || aStateLower === lowerQuery) return -1;
      if (bCityLower === lowerQuery || bStateLower === lowerQuery) return 1;

      // Starts with matches get second priority
      if (
        aCityLower.startsWith(lowerQuery) ||
        aStateLower.startsWith(lowerQuery)
      )
        return -1;
      if (
        bCityLower.startsWith(lowerQuery) ||
        bStateLower.startsWith(lowerQuery)
      )
        return 1;

      return 0;
    })
    .slice(0, 5);
};
